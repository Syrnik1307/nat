# –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ 10 000+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 22 —è–Ω–≤–∞—Ä—è 2026 –≥.  
**–ü—Ä–æ–µ–∫—Ç:** Teaching Panel LMS (Lectio Space)  
**–¢–µ–∫—É—â–∏–π –¥–æ–º–µ–Ω:** lectio.space, lectio.tw1.ru

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —Ö–æ–¥–µ –∞—É–¥–∏—Ç–∞

1. **admin.E122** - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `list_editable` –≤ `support/admin.py` (–¥–æ–±–∞–≤–ª–µ–Ω `priority` –≤ `list_display`)
2. **urls.W005** - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ namespace `accounts` –≤ `urls.py`

---

## –†–µ–∑—é–º–µ

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –°—Ç–∞—Ç—É—Å | –û—Ü–µ–Ω–∫–∞ |
|-----------|--------|--------|
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Production** | ‚úÖ –•–û–†–û–®–û | 8/10 |
| **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è/–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** | ‚úÖ –•–û–†–û–®–û | 9/10 |
| **–ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫** | ‚úÖ –•–û–†–û–®–û | 8/10 |
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** | ‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢ –í–ù–ò–ú–ê–ù–ò–Ø | 6/10 |
| **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** | ‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢ –í–ù–ò–ú–ê–ù–ò–Ø | 5/10 |

**–û–±—â–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ 10 000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 72%**

---

## 1. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Production (8/10)

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –Ω–∞ Production —Å–µ—Ä–≤–µ—Ä–µ

| –ù–∞—Å—Ç—Ä–æ–π–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|-----------|----------|--------|
| `DEBUG` | `False` | ‚úÖ OK |
| `SECRET_KEY` | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π 50+ —Å–∏–º–≤–æ–ª–æ–≤ | ‚úÖ OK |
| `SECURE_SSL_REDIRECT` | `True` | ‚úÖ OK |
| `SESSION_COOKIE_SECURE` | `True` | ‚úÖ OK |
| `CSRF_COOKIE_SECURE` | `True` | ‚úÖ OK |
| `ALLOWED_HOSTS` | –ù–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ | ‚úÖ OK |
| `CSRF_TRUSTED_ORIGINS` | –ù–∞—Å—Ç—Ä–æ–µ–Ω | ‚úÖ OK |
| `X_FRAME_OPTIONS` | `DENY` | ‚úÖ OK |
| `SECURE_CONTENT_TYPE_NOSNIFF` | `True` | ‚úÖ OK |

### ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

| –ü—Ä–æ–±–ª–µ–º–∞ | –†–∏—Å–∫ | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|----------|------|--------------|
| **SECURE_HSTS_SECONDS = 0** | –°—Ä–µ–¥–Ω–∏–π | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `SECURE_HSTS_SECONDS=31536000` (1 –≥–æ–¥) |
| **reCAPTCHA —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏** | –°—Ä–µ–¥–Ω–∏–π | –ü–æ–ª—É—á–∏—Ç—å production –∫–ª—é—á–∏ –Ω–∞ https://www.google.com/recaptcha/admin |
| **Zoom credentials –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã** | –ù–∏–∑–∫–∏–π | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Zoom API –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |

### üìã –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ .env –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è Production

```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ .env –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
SECURE_HSTS_SECONDS=31536000
SECURE_HSTS_INCLUDE_SUBDOMAINS=True
SECURE_HSTS_PRELOAD=True

# reCAPTCHA production –∫–ª—é—á–∏
RECAPTCHA_PUBLIC_KEY=–≤–∞—à_production_–∫–ª—é—á
RECAPTCHA_PRIVATE_KEY=–≤–∞—à_production_—Å–µ–∫—Ä–µ—Ç
RECAPTCHA_ENABLED=true
```

---

## 2. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (9/10)

### ‚úÖ –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è | –°—Ç–∞—Ç—É—Å |
|-----------|------------|--------|
| **JWT —Ç–æ–∫–µ–Ω—ã** | Simple JWT —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ claims (role) | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| **Token Lifetime** | Access: 12—á, Refresh: 12—á (remember_me: 365–¥) | ‚úÖ OK |
| **Token Rotation** | `ROTATE_REFRESH_TOKENS=True` | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ |
| **Token Blacklist** | –í–∫–ª—é—á–µ–Ω | ‚úÖ OK |
| **Password Validation** | 4 –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞ Django | ‚úÖ OK |
| **Login Lockout** | 5 –ø–æ–ø—ã—Ç–æ–∫ ‚Üí 10 –º–∏–Ω –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ | ‚úÖ OK |

### ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –±–æ—Ç–æ–≤ (–û—Ç–ª–∏—á–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è!)

```python
# accounts/bot_protection.py
- Device Fingerprinting (32 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞)
- Behavioral Analysis (–≤—Ä–µ–º—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–æ—Ä–º—ã)
- Rate Limiting –ø–æ fingerprint
- –ë–∞–Ω —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏—è—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π
```

### ‚úÖ Permissions (–•–æ—Ä–æ—à–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–æ)

| ViewSet | Permissions | –ü—Ä–æ–≤–µ—Ä–∫–∞ |
|---------|-------------|----------|
| GroupViewSet | IsAuthenticated + IsGroupOwnerOrReadOnly | ‚úÖ OK |
| LessonViewSet | IsAuthenticated + IsLessonOwnerOrReadOnly | ‚úÖ OK |
| HomeworkViewSet | IsTeacherHomework | ‚úÖ OK |
| StudentSubmissionViewSet | IsStudentSubmission | ‚úÖ OK |
| ZoomAccountViewSet (admin) | IsAdminRole | ‚úÖ OK |

### ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –°–æ–∫—Ä–∞—Ç–∏—Ç—å `ACCESS_TOKEN_LIFETIME` –¥–æ 1-2 —á–∞—Å–æ–≤ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
2. **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –î–æ–±–∞–≤–∏—Ç—å 2FA –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π –∏ –∞–¥–º–∏–Ω–æ–≤

---

## 3. –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫ (8/10)

### ‚úÖ SQL Injection

| –ü—Ä–æ–≤–µ—Ä–∫–∞ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|----------|-----------|
| –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Django ORM | ‚úÖ –í–µ–∑–¥–µ |
| Raw SQL queries | –¢–æ–ª—å–∫–æ –≤ –º–∏–≥—Ä–∞—Ü–∏—è—Ö –∏ —Å–ª—É–∂–µ–±–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–∞—Ö |
| –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã | ‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è |

**–í–µ—Ä–¥–∏–∫—Ç**: –†–∏—Å–∫ SQL injection –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π

### ‚úÖ XSS Protection

| –ü—Ä–æ–≤–µ—Ä–∫–∞ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|----------|-----------|
| `dangerouslySetInnerHTML` | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å `DOMPurify.sanitize()` ‚úÖ |
| `mark_safe` | –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
| Django Template Escaping | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ |
| DOMPurify –≤ Frontend | –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |

**–í–µ—Ä–¥–∏–∫—Ç**: XSS –∑–∞—â–∏—Ç–∞ —Ö–æ—Ä–æ—à–∞—è

### ‚úÖ CSRF Protection

| –ù–∞—Å—Ç—Ä–æ–π–∫–∞ | –°—Ç–∞—Ç—É—Å |
|-----------|--------|
| CsrfViewMiddleware | –í–∫–ª—é—á–µ–Ω |
| CSRF_COOKIE_SECURE | True –Ω–∞ prod |
| CSRF_COOKIE_HTTPONLY | True |
| Webhooks —Å @csrf_exempt | –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–æ–¥–ø–∏—Å–∏ |

### ‚úÖ Rate Limiting

```python
DEFAULT_THROTTLE_RATES = {
    'user': '5000/hour',      # –î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö
    'anon': '500/hour',       # –î–ª—è –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö
    'login': '300/hour',      # –î–ª—è –ª–æ–≥–∏–Ω–∞
    'submissions': '200/hour', # –î–ó
    'grading': '1000/hour',   # –û—Ü–µ–Ω–∏–≤–∞–Ω–∏–µ
}
```

**–í–µ—Ä–¥–∏–∫—Ç**: Rate limiting –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –Ω–æ –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å

---

## 4. –í–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (7/10)

### ‚úÖ YooKassa Webhooks

```python
# accounts/payments_views.py
- HMAC –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ ‚úÖ
- Webhook secret –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω ‚úÖ
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ ‚úÖ
```

### ‚úÖ T-Bank Webhooks

```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ Token –ø–æ–¥–ø–∏—Å–∏ ‚úÖ
```

### ‚ö†Ô∏è Zoom API

- Credentials –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ production
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ï—Å–ª–∏ Zoom –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Server-to-Server OAuth

### ‚úÖ Telegram Bot

- Token –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- Webhook secret –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

---

## 5. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (6/10)

### ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

```python
# schedule/models.py
indexes = [
    models.Index(fields=['start_time']),
    models.Index(fields=['teacher', 'start_time']),
    models.Index(fields=['group', 'start_time']),
]
```

### ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

- `select_related()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è ForeignKey
- `prefetch_related()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è ManyToMany
- `.distinct()` –≥–¥–µ –Ω—É–∂–Ω–æ

### ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –¥–ª—è 10K –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

| –ü—Ä–æ–±–ª–µ–º–∞ | –í–ª–∏—è–Ω–∏–µ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|---------|
| **SQLite –Ω–∞ production** | –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï | –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ PostgreSQL |
| **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ connection pooling** | –í—ã—Å–æ–∫–æ–µ | –î–æ–±–∞–≤–∏—Ç—å `django-db-connection-pool` |
| **–ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤** | –°—Ä–µ–¥–Ω–µ–µ | –í–Ω–µ–¥—Ä–∏—Ç—å Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ |
| **–õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª–æ–≤—ã–π storage** | –í—ã—Å–æ–∫–æ–µ | –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ S3/GCS –¥–ª—è –º–µ–¥–∏–∞ |

### üìä –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è 10K –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Load Balancer                        ‚îÇ
‚îÇ                   (nginx / HAProxy)                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚ñº            ‚ñº            ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ Django  ‚îÇ  ‚îÇ Django  ‚îÇ  ‚îÇ Django  ‚îÇ
    ‚îÇ App 1   ‚îÇ  ‚îÇ App 2   ‚îÇ  ‚îÇ App 3   ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ            ‚îÇ            ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ                 ‚îÇ                 ‚îÇ
    ‚ñº                 ‚ñº                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇPostgreSQL‚îÇ    ‚îÇ  Redis   ‚îÇ     ‚îÇ Celery   ‚îÇ
‚îÇ Primary  ‚îÇ    ‚îÇ Cluster  ‚îÇ     ‚îÇ Workers  ‚îÇ
‚îÇ+ Replica ‚îÇ    ‚îÇ          ‚îÇ     ‚îÇ (3-5)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## 6. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (5/10)

### ‚ö†Ô∏è –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å |
|-----------|--------|
| Sentry | –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (SENTRY_DSN –ø—É—Å—Ç–æ–π) |
| Structured Logging | –ë–∞–∑–æ–≤—ã–π |
| APM (Application Performance) | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç |
| Metrics (Prometheus/Grafana) | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç |

### üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Sentry** –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫:
   ```bash
   SENTRY_DSN=https://xxx@sentry.io/xxx
   ```

2. **–î–æ–±–∞–≤–∏—Ç—å APM** (New Relic / Datadog / Elastic APM)

3. **Metrics Endpoint** –¥–ª—è Prometheus:
   ```python
   # pip install django-prometheus
   INSTALLED_APPS += ['django_prometheus']
   ```

---

## 7. –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –Ω–∞ 10 000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ (–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ)

- [ ] **–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL** - SQLite –Ω–µ –≤—ã–¥–µ—Ä–∂–∏—Ç –Ω–∞–≥—Ä—É–∑–∫—É
- [ ] **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å HSTS** - `SECURE_HSTS_SECONDS=31536000`
- [ ] **Production reCAPTCHA –∫–ª—é—á–∏**
- [ ] **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Sentry** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ—à–∏–±–æ–∫

### üü° –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

- [ ] **Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è** (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å)
- [ ] **Connection pooling –¥–ª—è –ë–î**
- [ ] **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ Celery workers**
- [ ] **CDN –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏ –∏ –º–µ–¥–∏–∞** (Cloudflare/CloudFront)

### üü¢ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] **2FA –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π** (TOTP)
- [ ] **–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ ACCESS_TOKEN_LIFETIME** –¥–æ 1-2 —á–∞—Å–æ–≤
- [ ] **Audit logging** –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] **Backup automation** –¥–ª—è PostgreSQL
- [ ] **Health check endpoints** —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π

---

## 8. –û—Ü–µ–Ω–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è 10 000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –†–∞—Å—á—ë—Ç–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | 10 000 |
| –£—á–∏—Ç–µ–ª–µ–π | ~1 000 (10%) |
| –°—Ç—É–¥–µ–Ω—Ç–æ–≤ | ~9 000 (90%) |
| –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö (peak) | ~2 000 (20%) |
| –ó–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ (peak) | ~200-500 RPS |
| –£—Ä–æ–∫–æ–≤ –≤ –¥–µ–Ω—å | ~500-1000 |
| –î–ó –æ—Ç–ø—Ä–∞–≤–æ–∫ –≤ –¥–µ–Ω—å | ~3000-5000 |

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ú–∏–Ω–∏–º—É–º | –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è |
|-----------|---------|---------------|
| **Django App Servers** | 2 x 2CPU/4GB | 3 x 4CPU/8GB |
| **PostgreSQL** | 4CPU/8GB + replica | 8CPU/16GB + replica |
| **Redis** | 2CPU/4GB | 4CPU/8GB cluster |
| **Celery Workers** | 3 workers | 5 workers |
| **Storage** | 500GB SSD | 1TB SSD + S3 |
| **Load Balancer** | nginx | nginx + Cloudflare |

---

## 9. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Webhooks (–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑)

### YooKassa Webhook ‚úÖ

```python
# accounts/payments_views.py:17-48
@csrf_exempt
@require_http_methods(["POST"])
def yookassa_webhook(request):
    # ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Å–µ–∫—Ä–µ—Ç–∞
    webhook_secret = getattr(settings, 'YOOKASSA_WEBHOOK_SECRET', None)
    if not webhook_secret:
        return JsonResponse({'error': 'Webhooks disabled'}, status=503)
    
    # ‚úÖ HMAC –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏
    signature = request.headers.get('X-Yookassa-Signature', '')
    expected = hmac.new(...).hexdigest()
    if not hmac.compare_digest(signature, expected):
        return JsonResponse({'error': 'Invalid signature'}, status=403)
```

### T-Bank Webhook ‚úÖ

```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ Token –ø–æ–¥–ø–∏—Å–∏ –≤–∫–ª—é—á–µ–Ω–∞
```

---

## 10. –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–¥–æ –∑–∞–ø—É—Å–∫–∞)

1. **–î–æ–±–∞–≤–∏—Ç—å –≤ .env –Ω–∞ production:**
   ```bash
   SECURE_HSTS_SECONDS=31536000
   SECURE_HSTS_INCLUDE_SUBDOMAINS=True
   
   # –ü–æ–ª—É—á–∏—Ç—å –Ω–∞ https://www.google.com/recaptcha/admin
   RECAPTCHA_PUBLIC_KEY=production_key
   RECAPTCHA_PRIVATE_KEY=production_secret
   RECAPTCHA_ENABLED=true
   
   # Sentry
   SENTRY_DSN=your_sentry_dsn
   ```

2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å admin.py (–æ—à–∏–±–∫–∞ E122):**
   ```python
   # support/admin.py - –¥–æ–±–∞–≤–∏—Ç—å priority –≤ list_display
   ```

3. **–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL** (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è 10K)

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ (1-2 –Ω–µ–¥–µ–ª–∏)

1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CDN –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏
2. –î–æ–±–∞–≤–∏—Ç—å APM –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
4. –ü—Ä–æ–≤–µ—Å—Ç–∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (locust/k6)

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ

1. –í–Ω–µ–¥—Ä–∏—Ç—å 2FA
2. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –¥–ª—è –∑–∞–ø–∏—Å–µ–π/–≤–∏–¥–µ–æ
3. Cosmos DB –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (—É–∂–µ —á–∞—Å—Ç–∏—á–Ω–æ –≥–æ—Ç–æ–≤–æ)

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç **–≥–æ—Ç–æ–≤ –∫ production** —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –±–∞–∑–æ–≤–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (8/10).

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞—Ä—å–µ—Ä—ã –¥–ª—è 10 000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
1. SQLite ‚Üí PostgreSQL –º–∏–≥—Ä–∞—Ü–∏—è
2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ HSTS
3. –¢–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏ reCAPTCHA

–ü–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö 3 –ø—Ä–æ–±–ª–µ–º, –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤ –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é.

---

*–ê—É–¥–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω: GitHub Copilot*  
*–í–µ—Ä—Å–∏—è: 1.0*
