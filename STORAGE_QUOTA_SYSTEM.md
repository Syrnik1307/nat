# üíæ –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–≤–æ—Ç–∞–º–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

## –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–≤–æ—Ç–∞–º–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–ª—è –∑–∞–ø–∏—Å–µ–π —É—Ä–æ–∫–æ–≤:

- **–ö–≤–æ—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è** —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏** –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∑–∞–ø–∏—Å–µ–π
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –æ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ –∫ –ª–∏–º–∏—Ç—É

---

## üóÑÔ∏è Backend (Django)

### 1. –ú–æ–¥–µ–ª—å `TeacherStorageQuota`

**–§–∞–π–ª:** `teaching_panel/schedule/models.py`

**–ü–æ–ª—è:**
- `teacher` - —Å–≤—è–∑—å —Å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–º (OneToOne)
- `total_quota_bytes` - –æ–±—â–∞—è –∫–≤–æ—Ç–∞ –≤ –±–∞–π—Ç–∞—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5 –ì–ë)
- `used_bytes` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –±–∞–π—Ç–æ–≤
- `recordings_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
- `purchased_gb` - –¥–æ–∫—É–ø–ª–µ–Ω–Ω—ã–µ –≥–∏–≥–∞–±–∞–π—Ç—ã
- `quota_exceeded` - —Ñ–ª–∞–≥ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è
- `warning_sent` - —Ñ–ª–∞–≥ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (–ø—Ä–∏ 80%)

**–ú–µ—Ç–æ–¥—ã:**
- `can_upload(file_size_bytes)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏
- `add_recording(file_size_bytes)` - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- `remove_recording(file_size_bytes)` - —É–º–µ–Ω—å—à–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- `increase_quota(additional_gb)` - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–≤–æ—Ç—ã (–ø–æ–∫—É–ø–∫–∞)

**Properties:**
- `total_gb`, `used_gb`, `available_gb` - –∫–≤–æ—Ç—ã –≤ –ì–ë
- `usage_percent` - –ø—Ä–æ—Ü–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

### 2. API Endpoints (Admin Only)

**–§–∞–π–ª:** `teaching_panel/schedule/storage_views.py`

#### –°–ø–∏—Å–æ–∫ –∫–≤–æ—Ç
```http
GET /schedule/api/storage/quotas/
Query: search, exceeded, warning, sort
```

#### –î–µ—Ç–∞–ª–∏ –∫–≤–æ—Ç—ã
```http
GET /schedule/api/storage/quotas/<quota_id>/
```

#### –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–≤–æ—Ç—ã
```http
POST /schedule/api/storage/quotas/<quota_id>/increase/
Body: { "additional_gb": 10 }
```

#### –°–±—Ä–æ—Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
```http
POST /schedule/api/storage/quotas/<quota_id>/reset-warnings/
```

#### –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```http
GET /schedule/api/storage/statistics/
```
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
- –°—É–º–º–∞—Ä–Ω—ã–µ –∫–≤–æ—Ç—ã –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–π
- –¢–æ–ø-5 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Celery Tasks

**–§–∞–π–ª:** `teaching_panel/schedule/tasks.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `process_zoom_recording()`:**

1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–≤–æ—Ç—ã –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–≤–æ—Ç—ã (5 –ì–ë) –µ—Å–ª–∏ –Ω–µ—Ç
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –º–µ—Å—Ç–∞
4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–≤–æ—Ç—ã –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
5. –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏/–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–∏

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `cleanup_old_recordings()`:**

- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–≤–æ—Ç—ã –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞–ø–∏—Å–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –º–µ—Å—Ç–∞

**–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**

- `_notify_teacher_quota_exceeded()` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏
- `_notify_teacher_quota_warning()` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ 80%

---

### 4. –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å Django

**–§–∞–π–ª:** `teaching_panel/schedule/admin.py`

**–î–æ–±–∞–≤–ª–µ–Ω `TeacherStorageQuotaAdmin`:**

- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–≤–æ—Ç —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π
- –§–∏–ª—å—Ç—Ä—ã –ø–æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—é –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º
- –î–µ–π—Å—Ç–≤–∏—è: –¥–æ–±–∞–≤–∏—Ç—å 5 –ì–ë, –¥–æ–±–∞–≤–∏—Ç—å 10 –ì–ë, —Å–±—Ä–æ—Å–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

---

## üñ•Ô∏è Frontend (React)

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `AdminStorageManagementPage`

**–§–∞–π–ª:** `frontend/src/modules/Admin/AdminStorageManagementPage.js`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**

1. **–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** (6 –∫–∞—Ä—Ç–æ—á–µ–∫):
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ / –ö–≤–æ—Ç–∞
   - –°—Ä–µ–¥–Ω—è—è –∑–∞–≥—Ä—É–∑–∫–∞
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–π
   - –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π
   - –î–æ—Å—Ç—É–ø–Ω–æ –º–µ—Å—Ç–∞

2. **–¢–æ–ø-5 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
   - –ò–º—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–ì–ë –∏ %)
   - –í–∏–∑—É–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä

3. **–§–∏–ª—å—Ç—Ä—ã:**
   - –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏/email
   - –§–∏–ª—å—Ç—Ä –ø–æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—é –∫–≤–æ—Ç—ã
   - –§–∏–ª—å—Ç—Ä –ø–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (–ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é, –∫–≤–æ—Ç–µ, –ø—Ä–æ—Ü–µ–Ω—Ç—É)

4. **–¢–∞–±–ª–∏—Ü–∞ –∫–≤–æ—Ç:**
   - –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å (–∏–º—è + email)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ / –ö–≤–æ—Ç–∞ (–ì–ë)
   - –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
   - –°—Ç–∞—Ç—É—Å (OK / –ü—Ä–µ–¥—É–ø—Ä. / –ü—Ä–µ–≤—ã—à–µ–Ω–∞)
   - –î–µ–π—Å—Ç–≤–∏—è (—É–≤–µ–ª–∏—á–∏—Ç—å, —Å–±—Ä–æ—Å–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è)

5. **–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–≤–µ–ª–∏—á–µ–Ω–∏—è –∫–≤–æ—Ç—ã:**
   - –í—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ì–ë (1-100)
   - –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –Ω–æ–≤–æ–π –∫–≤–æ—Ç—ã
   - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

**–¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è:**
- üü¢ –ó–µ–ª–µ–Ω—ã–π: < 80%
- üü† –û—Ä–∞–Ω–∂–µ–≤—ã–π: 80-90%
- üî¥ –ö—Ä–∞—Å–Ω—ã–π: > 90%

---

## üìã Workflow —Å–∏—Å—Ç–µ–º—ã –∫–≤–æ—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–≤–æ—Ç—ã

–ü—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ –∑–∞–ø–∏—Å–∏:
```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–≤–æ—Ç–∞ 5 –ì–ë
quota = TeacherStorageQuota.objects.create(
    teacher=teacher,
    total_quota_bytes=5 * 1024 ** 3
)
```

### 2. –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–∏—Å–∏

```
1. Zoom –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç webhook ‚Üí recording.completed
2. Celery –∑–∞–¥–∞—á–∞ process_zoom_recording():
   - –ü—Ä–æ–≤–µ—Ä–∫–∞: quota.quota_exceeded?
   - –ï—Å–ª–∏ –¥–∞ ‚Üí —Å—Ç–∞—Ç—É—Å 'failed', —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
   - –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Å Zoom
   - –ü—Ä–æ–≤–µ—Ä–∫–∞: quota.can_upload(file_size)?
   - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí —Å—Ç–∞—Ç—É—Å 'failed', —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
   - –ó–∞–≥—Ä—É–∑–∫–∞ –≤ Google Drive
   - quota.add_recording(file_size)
   - –ï—Å–ª–∏ usage_percent >= 80% ‚Üí –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
```

### 3. –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏

```
1. Celery –∑–∞–¥–∞—á–∞ cleanup_old_recordings():
   - –ù–∞—Ö–æ–¥–∏—Ç expired recordings
   - –£–¥–∞–ª—è–µ—Ç –∏–∑ Google Drive
   - quota.remove_recording(file_size)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–Ω–∏–º–∞–µ—Ç —Ñ–ª–∞–≥–∏ quota_exceeded/warning_sent
```

### 4. –ü–æ–∫—É–ø–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –º–µ—Å—Ç–∞

```
1. –ê–¥–º–∏–Ω –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É /admin/storage
2. –í—ã–±–∏—Ä–∞–µ—Ç –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è ‚Üí "–£–≤–µ–ª–∏—á–∏—Ç—å –∫–≤–æ—Ç—É"
3. –£–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ì–ë ‚Üí –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
4. API: POST /schedule/api/storage/quotas/{id}/increase/
5. quota.increase_quota(additional_gb)
6. –§–ª–∞–≥–∏ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è, –∑–∞–ø–∏—Å–∏ —Å–Ω–æ–≤–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
```

---

## üöÄ –ú–∞—Ä—à—Ä—É—Ç—ã

### Backend API:
- `GET /schedule/api/storage/quotas/` - —Å–ø–∏—Å–æ–∫ –∫–≤–æ—Ç
- `GET /schedule/api/storage/quotas/<id>/` - –¥–µ—Ç–∞–ª–∏ –∫–≤–æ—Ç—ã
- `POST /schedule/api/storage/quotas/<id>/increase/` - —É–≤–µ–ª–∏—á–∏—Ç—å –∫–≤–æ—Ç—É
- `POST /schedule/api/storage/quotas/<id>/reset-warnings/` - —Å–±—Ä–æ—Å–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `GET /schedule/api/storage/statistics/` - –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `GET /schedule/api/storage/teachers/<id>/recordings/` - –∑–∞–ø–∏—Å–∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
- `POST /schedule/api/storage/quotas/create/` - —Å–æ–∑–¥–∞—Ç—å –∫–≤–æ—Ç—É –≤—Ä—É—á–Ω—É—é

### Frontend:
- `/admin/storage` - –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º

---

## ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
cd /var/www/teaching_panel/teaching_panel
source ../venv/bin/activate
python manage.py makemigrations
python manage.py migrate
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –∫–≤–æ—Ç –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π

```python
# Django shell
python manage.py shell

from accounts.models import CustomUser
from schedule.models import TeacherStorageQuota

teachers = CustomUser.objects.filter(role='teacher')
for teacher in teachers:
    TeacherStorageQuota.objects.get_or_create(
        teacher=teacher,
        defaults={'total_quota_bytes': 5 * 1024 ** 3}
    )
```

### 3. Frontend build

```bash
cd frontend
npm run build
```

---

## üìä –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–≤–æ—Ç—ã —á–µ—Ä–µ–∑ Django shell

```python
from schedule.models import TeacherStorageQuota

# –ü–æ–ª—É—á–∏—Ç—å –∫–≤–æ—Ç—É –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
quota = TeacherStorageQuota.objects.get(teacher_id=1)

print(f"–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: {quota.used_gb:.2f} –ì–ë")
print(f"–ö–≤–æ—Ç–∞: {quota.total_gb:.2f} –ì–ë")
print(f"–î–æ—Å—Ç—É–ø–Ω–æ: {quota.available_gb:.2f} –ì–ë")
print(f"–ü—Ä–æ—Ü–µ–Ω—Ç: {quota.usage_percent:.1f}%")
print(f"–ü—Ä–µ–≤—ã—à–µ–Ω–∞: {quota.quota_exceeded}")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ 500 –ú–ë
file_size = 500 * 1024 ** 2
can_upload = quota.can_upload(file_size)
print(f"–ú–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å 500 –ú–ë: {can_upload}")

# –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–≤–æ—Ç—ã –Ω–∞ 10 –ì–ë
quota.increase_quota(10)
print(f"–ù–æ–≤–∞—è –∫–≤–æ—Ç–∞: {quota.total_gb:.2f} –ì–ë")
```

### API –∑–∞–ø—Ä–æ—Å—ã

```bash
# –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–≤–æ—Ç (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)
curl -H "Authorization: Bearer <token>" \
  http://72.56.81.163/schedule/api/storage/quotas/

# –£–≤–µ–ª–∏—á–∏—Ç—å –∫–≤–æ—Ç—É –Ω–∞ 10 –ì–ë
curl -X POST \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{"additional_gb": 10}' \
  http://72.56.81.163/schedule/api/storage/quotas/5/increase/

# –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
curl -H "Authorization: Bearer <token>" \
  http://72.56.81.163/schedule/api/storage/statistics/
```

---

## üí° –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### –ë–∞–∑–æ–≤–∞—è –∫–≤–æ—Ç–∞
- **5 –ì–ë** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
- –°–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–ø–∏—Å–∏

### –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- **80%** - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ (—Ñ–ª–∞–≥ `warning_sent=True`)
- **100%** - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π (—Ñ–ª–∞–≥ `quota_exceeded=True`)

### –ü–æ–∫—É–ø–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –º–µ—Å—Ç–∞
- –ê–¥–º–∏–Ω —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∫–≤–æ—Ç—É —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç 1 –¥–æ 100 –ì–ë –∑–∞ —Ä–∞–∑
- –ü–æ–ª–µ `purchased_gb` –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Å—É–º–º—É –¥–æ–∫—É–ø–æ–∫
- –§–ª–∞–≥–∏ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞
- –ó–∞–¥–∞—á–∞ `cleanup_old_recordings()` —É–¥–∞–ª—è–µ—Ç expired –∑–∞–ø–∏—Å–∏
- –ö–≤–æ—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è
- –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ < 80%, —Ñ–ª–∞–≥ `warning_sent` —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è

---

## üìù TODO (–±—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è)

1. **Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
   - –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ 80% –∫–≤–æ—Ç—ã
   - –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ 100% –∫–≤–æ—Ç—ã
   - –ü—Ä–∏ –∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞–ø–∏—Å–µ–π

2. **Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Bot API
   - –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è–º

3. **–ü–ª–∞—Ç–µ–∂–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–∫—É–ø–∫–∞ –º–µ—Å—Ç–∞ —á–µ—Ä–µ–∑ –ø–ª–∞—Ç–µ–∂–Ω—É—é —Å–∏—Å—Ç–µ–º—É
   - –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

4. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞:**
   - –ì—Ä–∞—Ñ–∏–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
   - –ü—Ä–æ–≥–Ω–æ–∑ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∫–≤–æ—Ç—ã
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

5. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
   - –°–∂–∞—Ç–∏–µ –≤–∏–¥–µ–æ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
   - –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ –∫ –∫–≤–æ—Ç–µ

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –í—Å–µ API endpoints –∑–∞—â–∏—â–µ–Ω—ã `@permission_classes([IsAuthenticated])`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ `admin` –Ω–∞ –∫–∞–∂–¥–æ–º endpoint
- ‚úÖ –ö–≤–æ—Ç—ã –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—é (OneToOne)
- ‚úÖ –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –∫–≤–æ—Ç—É —á–µ—Ä–µ–∑ –æ–±—ã—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

---

## üì¶ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Backend:
1. `teaching_panel/schedule/models.py` - –º–æ–¥–µ–ª—å `TeacherStorageQuota`
2. `teaching_panel/schedule/storage_views.py` - API endpoints (NEW)
3. `teaching_panel/schedule/serializers.py` - `TeacherStorageQuotaSerializer`
4. `teaching_panel/schedule/admin.py` - –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –¥–ª—è –∫–≤–æ—Ç
5. `teaching_panel/schedule/urls.py` - –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è API
6. `teaching_panel/schedule/tasks.py` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–¥–∞—á–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∫–≤–æ—Ç

### Frontend:
7. `frontend/src/modules/Admin/AdminStorageManagementPage.js` (NEW)
8. `frontend/src/modules/Admin/AdminStorageManagementPage.css` (NEW)
9. `frontend/src/App.js` - –¥–æ–±–∞–≤–ª–µ–Ω –º–∞—Ä—à—Ä—É—Ç `/admin/storage`
10. `frontend/src/components/AdminHomePage.js` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "üíæ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º"

---

## üéØ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é. –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç:
- –í–∏–¥–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –≤—Å–µ—Ö –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π
- –£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –∫–≤–æ—Ç—ã –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—é—Ç –∫–≤–æ—Ç—É 5 –ì–ë –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–ø–∏—Å–∏ —É—Ä–æ–∫–∞.
