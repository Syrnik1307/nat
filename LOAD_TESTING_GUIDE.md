# üöÄ LOAD TESTING GUIDE - Teaching Panel LMS

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ
1. **–°–æ–∑–¥–∞–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:**
   - 1,002 —É—á–∏—Ç–µ–ª—è
   - 3,003 —É—á–µ–Ω–∏–∫–∞
   - 10 –∫—É—Ä—Å–æ–≤
   - 52 –≥—Ä—É–ø–ø—ã
   - 500 –¥–æ–º–∞—à–Ω–∏—Ö –∑–∞–¥–∞–Ω–∏–π
   - 2,500 –≤–æ–ø—Ä–æ—Å–æ–≤
   - 1,500 —Ä–∞–±–æ—Ç —É—á–µ–Ω–∏–∫–æ–≤
   - 7,500 –æ—Ç–≤–µ—Ç–æ–≤

2. **–ó–∞–ø—É—â–µ–Ω—ã —Å–µ—Ä–≤–∏—Å—ã:**
   - Django —Å–µ—Ä–≤–µ—Ä: `http://127.0.0.1:8000`
   - Locust –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: `http://localhost:8089`

## üéØ –ö–∞–∫ –ø—Ä–æ–≤–µ—Å—Ç–∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –®–∞–≥ 1: –û—Ç–∫—Ä—ã—Ç—å Locust –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
```
http://localhost:8089
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ—Å—Ç–∞
–í –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –≤–≤–µ–¥–∏—Ç–µ:
- **Number of users**: `4000` (—Å–∏–º—É–ª–∏—Ä—É–µ—Ç 1000 —É—á–∏—Ç–µ–ª–µ–π + 3000 —É—á–µ–Ω–∏–∫–æ–≤)
- **Spawn rate**: `50` (50 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å–µ–∫—É–Ω–¥—É)
- **Host**: `http://127.0.0.1:8000` (—É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç
–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"Start swarming"**

### –®–∞–≥ 4: –ù–∞–±–ª—é–¥–∞—Ç—å –∑–∞ –º–µ—Ç—Ä–∏–∫–∞–º–∏
Locust –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
- **Total Requests per Second (RPS)** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
- **Response Times (P50, P95, P99)** - –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ (–º–µ–¥–∏–∞–Ω–∞, 95 –∏ 99 –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª–∏)
- **Failure Rate** - –ø—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫
- **Number of Users** - —Ç–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üìà –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### TeacherUser (25% –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
**–ß–∞—Å—Ç–æ—Ç–∞ –¥–µ–π—Å—Ç–≤–∏–π:**
- **task(3)** - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ —Ä–∞–±–æ—Ç (`/api/submissions/`)
- **task(2)** - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –î–ó (`/api/homework/`)
- **task(2)** - –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (`/api/schedule/lessons/`)
- **task(1)** - –í—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏ (`PATCH /api/submissions/{id}/update_answer/`)
- **task(1)** - –ü—Ä–æ—Å–º–æ—Ç—Ä –≥—Ä—É–ø–ø (`/api/groups/`)

**–ü–∞—É–∑–∞ –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏:** 2-5 —Å–µ–∫—É–Ω–¥

### StudentUser (70% –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
**–ß–∞—Å—Ç–æ—Ç–∞ –¥–µ–π—Å—Ç–≤–∏–π:**
- **task(5)** - –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π (`/api/homework/`)
- **task(3)** - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–∏—Ö —Ä–∞–±–æ—Ç (`/api/submissions/`)
- **task(2)** - –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (`/api/schedule/lessons/`)
- **task(1)** - –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–æ–º–∞—à–Ω–µ–π —Ä–∞–±–æ—Ç—ã (`POST /api/submissions/`)

**–ü–∞—É–∑–∞ –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏:** 3-8 —Å–µ–∫—É–Ω–¥

### AnonymousUser (5% –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- –ü–æ—Å–µ—â–µ–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- Health check

## üéØ –¶–µ–ª–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

### –û—Ç–ª–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- **RPS**: > 100 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫
- **Response Time P95**: < 500ms
- **Response Time P99**: < 1000ms
- **Failure Rate**: < 1%

### –ü—Ä–∏–µ–º–ª–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- **RPS**: > 50 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫
- **Response Time P95**: < 1000ms
- **Response Time P99**: < 2000ms
- **Failure Rate**: < 5%

### –¢—Ä–µ–±—É—é—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- **Response Time P95**: > 1000ms
- **Response Time P99**: > 2000ms
- **Failure Rate**: > 5%

## üìä –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### 1. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ Django
```powershell
# –õ–æ–≥–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (–∏–∑ RequestMetricsMiddleware)
Get-Content teaching_panel/logs/requests.log -Tail 50

# –û—Å–Ω–æ–≤–Ω—ã–µ –ª–æ–≥–∏ Django
Get-Content teaching_panel/logs/django.log -Tail 50
```

### 2. –ù–∞–π—Ç–∏ –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
```powershell
# –ó–∞–ø—Ä–æ—Å—ã –¥–æ–ª—å—à–µ 2 —Å–µ–∫—É–Ω–¥
Select-String -Path teaching_panel/logs/requests.log -Pattern "duration=\d\.\d{3,}" | Select-Object -First 20
```

### 3. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ Locust
–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–∞:
- –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"Stop"**
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"Charts"** –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
- –í–∫–ª–∞–¥–∫–∞ **"Failures"** –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ –æ—à–∏–±–∫–∏
- –í–∫–ª–∞–¥–∫–∞ **"Download Data"** - —ç–∫—Å–ø–æ—Ä—Ç CSV

### 4. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å HTML –æ—Ç—á—ë—Ç
–í Locust –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –Ω–∞–∂–º–∏—Ç–µ **"Download Report"** —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π HTML –æ—Ç—á—ë—Ç.

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ï—Å–ª–∏ –º–Ω–æ–≥–æ –æ—à–∏–±–æ–∫ 401 (Unauthorized):
–¢–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ñ–∏–∫—Ç–∏–≤–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã. –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.

### –ï—Å–ª–∏ Response Time —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–π:
1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –ë–î** - —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –º–∏–≥—Ä–∞—Ü–∏—è—Ö
2. **–í–∫–ª—é—á–∏—Ç—å Redis –∫–µ—à** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   ```powershell
   # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Redis
   docker run -d -p 6379:6379 redis:latest
   
   # –û–±–Ω–æ–≤–∏—Ç—å .env
   REDIS_URL=redis://localhost:6379/0
   ```
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å N+1 –∑–∞–ø—Ä–æ—Å—ã** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `prefetch_related` (—É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–¥–µ)

### –ï—Å–ª–∏ Failure Rate > 5%:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Django –Ω–∞ –æ—à–∏–±–∫–∏
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–î constraints (unique_together –∏ —Ç.–¥.)
3. –£–º–µ–Ω—å—à–∏—Ç—å spawn rate (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ 20)

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ù–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç—Ä–∏–∫ —Ä–µ—à–∏—Ç—å:

1. **–ï—Å–ª–∏ –≤—Å—ë —Ö–æ—Ä–æ—à–æ (< 500ms P95):**
   - ‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production
   - –ú–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ PostgreSQL + Gunicorn

2. **–ï—Å–ª–∏ —Å—Ä–µ–¥–Ω–µ (500-1000ms P95):**
   - ‚ö†Ô∏è –í–∫–ª—é—á–∏—Ç—å Redis –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –î–æ–±–∞–≤–∏—Ç—å Connection Pooling
   - –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å Read Replicas –¥–ª—è –ë–î

3. **–ï—Å–ª–∏ –ø–ª–æ—Ö–æ (> 1000ms P95):**
   - ‚ùå –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
   - –í–∫–ª—é—á–∏—Ç—å database query logging
   - –î–æ–±–∞–≤–∏—Ç—å Celery –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
   - –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —à–∞—Ä–¥–∏–Ω–≥ –ë–î

## üöÄ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º (–±–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞):
```powershell
cd teaching_panel
..\\.venv\Scripts\locust.exe -f locustfile.py `
    --host=http://127.0.0.1:8000 `
    --headless `
    --users 4000 `
    --spawn-rate 50 `
    --run-time 5m `
    --html=load_test_report.html `
    --csv=load_test_results
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç:
- `load_test_report.html` - –≤–∏–∑—É–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç
- `load_test_results_stats.csv` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
- `load_test_results_failures.csv` - –≤—Å–µ –æ—à–∏–±–∫–∏
- `load_test_results_exceptions.csv` - –∏—Å–∫–ª—é—á–µ–Ω–∏—è

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **Locust –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: https://docs.locust.io/
- **Django –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: https://docs.djangoproject.com/en/4.2/topics/performance/
- **DRF –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: https://www.django-rest-framework.org/topics/performance/

## ‚úÖ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
1. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å production-–æ–∫—Ä—É–∂–µ–Ω–∏–µ (PostgreSQL, Gunicorn, Nginx)
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Sentry —É–∂–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω)
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD pipeline
5. ‚úÖ –ü—Ä–æ–≤–µ—Å—Ç–∏ security –∞—É–¥–∏—Ç
