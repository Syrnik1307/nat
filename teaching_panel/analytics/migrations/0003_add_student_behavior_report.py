# Generated by Django 4.2.26 on 2025-12-26 14:08

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('schedule', '0018_lesson_title_optional'),
        ('analytics', '0002_add_student_ai_report'),
    ]

    operations = [
        migrations.CreateModel(
            name='StudentBehaviorReport',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('status', models.CharField(choices=[('pending', '–û–∂–∏–¥–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏'), ('generating', '–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è'), ('completed', '–ì–æ—Ç–æ–≤'), ('failed', '–û—à–∏–±–∫–∞')], default='pending', max_length=20)),
                ('period_start', models.DateField(blank=True, null=True)),
                ('period_end', models.DateField(blank=True, null=True)),
                ('total_lessons', models.IntegerField(default=0, help_text='–í—Å–µ–≥–æ –∑–∞–Ω—è—Ç–∏–π –∑–∞ –ø–µ—Ä–∏–æ–¥')),
                ('attended_lessons', models.IntegerField(default=0, help_text='–ü–æ—Å–µ—â–µ–Ω–æ –∑–∞–Ω—è—Ç–∏–π')),
                ('missed_lessons', models.IntegerField(default=0, help_text='–ü—Ä–æ–ø—É—â–µ–Ω–æ –∑–∞–Ω—è—Ç–∏–π')),
                ('late_arrivals', models.IntegerField(default=0, help_text='–û–ø–æ–∑–¥–∞–Ω–∏—è –Ω–∞ –∑–∞–Ω—è—Ç–∏—è')),
                ('attendance_rate', models.FloatField(blank=True, help_text='–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏', null=True)),
                ('total_homework', models.IntegerField(default=0, help_text='–í—Å–µ–≥–æ –î–ó –∑–∞ –ø–µ—Ä–∏–æ–¥')),
                ('submitted_on_time', models.IntegerField(default=0, help_text='–°–¥–∞–Ω–æ –≤–æ–≤—Ä–µ–º—è')),
                ('submitted_late', models.IntegerField(default=0, help_text='–°–¥–∞–Ω–æ —Å –æ–ø–æ–∑–¥–∞–Ω–∏–µ–º')),
                ('not_submitted', models.IntegerField(default=0, help_text='–ù–µ —Å–¥–∞–Ω–æ')),
                ('homework_rate', models.FloatField(blank=True, help_text='–ü—Ä–æ—Ü–µ–Ω—Ç —Å–¥–∞–Ω–Ω—ã—Ö –î–ó', null=True)),
                ('avg_score', models.FloatField(blank=True, help_text='–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª', null=True)),
                ('score_trend', models.CharField(blank=True, choices=[('improving', 'üìà –£–ª—É—á—à–∞–µ—Ç—Å—è'), ('stable', '‚û°Ô∏è –°—Ç–∞–±–∏–ª—å–Ω–æ'), ('declining', 'üìâ –£—Ö—É–¥—à–∞–µ—Ç—Å—è')], max_length=20, null=True)),
                ('control_points_count', models.IntegerField(default=0, help_text='–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫')),
                ('control_points_avg', models.FloatField(blank=True, help_text='–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö', null=True)),
                ('risk_level', models.CharField(blank=True, choices=[('low', 'üü¢ –ù–∏–∑–∫–∏–π'), ('medium', 'üü° –°—Ä–µ–¥–Ω–∏–π'), ('high', 'üî¥ –í—ã—Å–æ–∫–∏–π')], max_length=10, null=True)),
                ('reliability_score', models.IntegerField(blank=True, help_text='–ë–∞–ª–ª –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏ 0-100', null=True)),
                ('ai_analysis', models.JSONField(blank=True, default=dict, help_text='\n    {\n        "profile_type": "responsible|needs_attention|at_risk",\n        "strengths": ["–†–µ–≥—É–ª—è—Ä–Ω–æ –ø–æ—Å–µ—â–∞–µ—Ç –∑–∞–Ω—è—Ç–∏—è", ...],\n        "concerns": ["–ß–∞—Å—Ç–æ –æ–ø–∞–∑–¥—ã–≤–∞–µ—Ç", "–ù–µ —Å–¥–∞—ë—Ç –î–ó –≤–æ–≤—Ä–µ–º—è", ...],\n        "patterns": [\n            {"type": "attendance", "description": "–ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç –∑–∞–Ω—è—Ç–∏—è –ø–æ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞–º"},\n            {"type": "homework", "description": "–°–¥–∞—ë—Ç –î–ó –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–æ–º–µ–Ω—Ç"}\n        ],\n        "recommendations": [\n            {"priority": "high", "action": "–°–≤—è–∑–∞—Ç—å—Å—è —Å —É—á–µ–Ω–∏–∫–æ–º –ø–æ –ø–æ–≤–æ–¥—É –ø—Ä–æ–ø—É—Å–∫–æ–≤"},\n            {"priority": "medium", "action": "–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∑–∞–ø–∏—Å–∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–∞–Ω—è—Ç–∏–π"}\n        ],\n        "alerts": [\n            {"type": "warning", "message": "–ü—Ä–æ–ø—É—Å—Ç–∏–ª 3 –∑–∞–Ω—è—Ç–∏—è –ø–æ–¥—Ä—è–¥"}\n        ],\n        "predicted_completion_probability": 75,\n        "summary": "–ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –æ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ —É—á–µ–Ω–∏–∫–∞..."\n    }\n    ')),
                ('ai_provider', models.CharField(default='deepseek', max_length=20)),
                ('ai_confidence', models.FloatField(blank=True, null=True)),
                ('ai_tokens_used', models.IntegerField(default=0)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('group', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='behavior_reports', to='schedule.group')),
                ('student', models.ForeignKey(limit_choices_to={'role': 'student'}, on_delete=django.db.models.deletion.CASCADE, related_name='behavior_reports', to=settings.AUTH_USER_MODEL)),
                ('teacher', models.ForeignKey(limit_choices_to={'role': 'teacher'}, on_delete=django.db.models.deletion.CASCADE, related_name='student_behavior_reports', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': '–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π AI-–æ—Ç—á—ë—Ç',
                'verbose_name_plural': '–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ AI-–æ—Ç—á—ë—Ç—ã',
                'ordering': ['-created_at'],
                'unique_together': {('student', 'teacher', 'group', 'period_start', 'period_end')},
            },
        ),
    ]
