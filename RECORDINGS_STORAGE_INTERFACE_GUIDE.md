# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–∏—Å—Ç–µ–º–µ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –∑–∞–ø–∏—Å–µ–π —É—Ä–æ–∫–æ–≤

–î–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–∏—Å—Ç–µ–º—ã –∑–∞–ø–∏—Å–∏ —É—Ä–æ–∫–æ–≤ Teaching Panel, –≤–∫–ª—é—á–∞—è —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–∏–¥–µ–æ –Ω–∞ Google Drive, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É —á–µ—Ä–µ–∑ Zoom webhooks, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–≤–æ—Ç–∞–º–∏, UI –¥–ª—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π –∏ —É—á–µ–Ω–∏–∫–æ–≤, –∞ —Ç–∞–∫–∂–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–∂–∞—Ç–∏—è –∑–∞–ø–∏—Å–µ–π.

---

## 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### 1.1 –•—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π (Google Drive)

**–¢–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ**: –ó–∞–ø–∏—Å–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ **–ª–∏—á–Ω–æ–º Google Drive —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞** —á–µ—Ä–µ–∑ Service Account —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –ø–∞–ø–∫–µ.

**–ü–æ—á–µ–º—É Google Drive:**
- –ë–µ—Å–ø–ª–∞—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (–≤ —Ä–∞–º–∫–∞—Ö –ª–∏–º–∏—Ç–æ–≤ Google Workspace)
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞
- –ü—Ä–æ—Å—Ç–æ–µ API –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏/—É–¥–∞–ª–µ–Ω–∏—è/—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞–º–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä—è–º–æ–≥–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —á–µ—Ä–µ–∑ embed URL
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–≤—å—é (thumbnails) –¥–ª—è –≤–∏–¥–µ–æ

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è:**
```
Google Drive (Personal)
‚îî‚îÄ‚îÄ Teaching Panel Recordings/          # –ö–æ—Ä–Ω–µ–≤–∞—è –ø–∞–ø–∫–∞ (GDRIVE_RECORDINGS_FOLDER_ID)
    ‚îú‚îÄ‚îÄ Group A - Math - 2025-12-02 10:00.mp4
    ‚îú‚îÄ‚îÄ Group B - Physics - 2025-12-02 14:00.mp4
    ‚îî‚îÄ‚îÄ ...
```

**Service Account –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:**
- –°–æ–∑–¥–∞–Ω –≤ Google Cloud Console —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ Drive API
- JSON credentials –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä (`gdrive-credentials.json`)
- –ü—Ä–∞–≤–∞ Editor –Ω–∞ –ø–∞–ø–∫—É "Teaching Panel Recordings"
- –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–∞–ø–∫–∏: `GDRIVE_RECORDINGS_FOLDER_ID` –≤ `settings.py`

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –õ–∏–º–∏—Ç –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–≤–æ—Ç—ã Google Drive –≤–ª–∞–¥–µ–ª—å—Ü–∞
- –†–∞–∑–º–µ—Ä –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞: –¥–æ 5 TB (–≤ —Ç–µ–æ—Ä–∏–∏), –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ ~10 GB –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
- –°–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏/—Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–µ—Ç–∏ –∏ —Ç–∞—Ä–∏—Ñ–∞ Google

---

### 1.2 –ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø–∏—Å–µ–π

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å‚îÇ
‚îÇ  —Å–æ–∑–¥–∞–µ—Ç —É—Ä–æ–∫ ‚îÇ‚îÄ‚îÄ‚ñ∫ [‚úì] record_lesson = True
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    [90] recording_available_for_days
        ‚îÇ
        ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Zoom Meeting  ‚îÇ
‚îÇ  –∞–≤—Ç–æ–∑–∞–ø–∏—Å—å    ‚îÇ‚óÑ‚îÄ‚îÄ Zoom –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ (–∑–∞–Ω—è—Ç–∏–µ –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å)
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Zoom Cloud Storage ‚îÇ
‚îÇ  –æ–±—Ä–∞–±–æ—Ç–∫–∞...       ‚îÇ‚îÄ‚îÄ‚ñ∫ ~5-10 –º–∏–Ω—É—Ç –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ    Webhook   ‚îÇ‚îÄ‚îÄ‚ñ∫ POST /schedule/api/zoom/webhook/
    ‚îÇ  recording.  ‚îÇ     { event: "recording.completed", payload: {...} }
    ‚îÇ  completed   ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  webhooks.py   ‚îÇ‚îÄ‚îÄ‚ñ∫ 1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å Zoom
    ‚îÇ  Handler       ‚îÇ‚îÄ‚îÄ‚ñ∫ 2. –°–æ–∑–¥–∞–µ—Ç LessonRecording (status=processing)
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÄ‚îÄ‚ñ∫ 3. –ó–∞–ø—É—Å–∫–∞–µ—Ç Celery task
             ‚îÇ
             ‚ñº
      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
      ‚îÇ   tasks.py       ‚îÇ‚îÄ‚îÄ‚ñ∫ process_zoom_recording()
      ‚îÇ   Celery Task    ‚îÇ
      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚îÇ
      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
      ‚îÇ                  ‚îÇ
      ‚ñº                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Zoom    ‚îÇ      ‚îÇ Google Drive   ‚îÇ
‚îÇ download ‚îÇ‚îÄ‚îÄ‚ñ∫‚îÄ‚îÄ‚îÄ‚îÇ   upload       ‚îÇ‚îÄ‚îÄ‚ñ∫ gdrive_utils.py::upload_recording()
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚ñº
                  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                  ‚îÇ  LessonRecording‚îÇ‚îÄ‚îÄ‚ñ∫ status = 'ready'
                  ‚îÇ  gdrive_file_id ‚îÇ‚îÄ‚îÄ‚ñ∫ gdrive_file_id = '1a2b3c...'
                  ‚îÇ  play_url       ‚îÇ‚îÄ‚îÄ‚ñ∫ play_url –¥–ª—è embed
                  ‚îÇ  file_size      ‚îÇ‚îÄ‚îÄ‚ñ∫ file_size_bytes
                  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚ñº
                  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                  ‚îÇ TeacherStorageQuota‚îÇ‚îÄ‚îÄ‚ñ∫ add_recording(file_size)
                  ‚îÇ  used_bytes +=  ‚îÇ‚îÄ‚îÄ‚ñ∫ –û–±–Ω–æ–≤–ª—è–µ—Ç –∫–≤–æ—Ç—É –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
                  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚ñº
                  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                  ‚îÇ   –£—á–µ–Ω–∏–∫–∏       ‚îÇ‚îÄ‚îÄ‚ñ∫ –ú–æ–≥—É—Ç —Å–º–æ—Ç—Ä–µ—Ç—å —á–µ—Ä–µ–∑ RecordingsPage
                  ‚îÇ   –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å ‚îÇ‚îÄ‚îÄ‚ñ∫ –£–ø—Ä–∞–≤–ª—è–µ—Ç —á–µ—Ä–µ–∑ TeacherRecordingsPage
                  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚îÇ –ü–æ—Å–ª–µ recording_available_for_days –¥–Ω–µ–π
                           ‚ñº
                  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                  ‚îÇ  Celery Beat    ‚îÇ‚îÄ‚îÄ‚ñ∫ cleanup_old_recordings()
                  ‚îÇ  Daily cleanup  ‚îÇ‚îÄ‚îÄ‚ñ∫ –£–¥–∞–ª—è–µ—Ç –∏–∑ Google Drive
                  ‚îÇ  03:00 UTC      ‚îÇ‚îÄ‚îÄ‚ñ∫ –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –∫–≤–æ—Ç—É
                  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## 2. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### 2.1 Lesson (–∑–∞–ø–∏—Å—å —É—Ä–æ–∫–∞)

```python
# teaching_panel/schedule/models.py

class Lesson(models.Model):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è ...
    
    record_lesson = models.BooleanField(
        '–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —É—Ä–æ–∫',
        default=False,
        help_text='–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —É—Ä–æ–∫ –≤ Zoom –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ Google Drive'
    )
    
    recording_available_for_days = models.IntegerField(
        '–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏ (–¥–Ω–µ–π)',
        default=90,
        help_text='–°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –∑–∞–ø–∏—Å—å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ —É—á–µ–Ω–∏–∫–∞–º (0 = –±–µ—Å—Å—Ä–æ—á–Ω–æ)'
    )
```

### 2.2 LessonRecording (–∑–∞–ø–∏—Å—å –≤–∏–¥–µ–æ)

```python
class LessonRecording(models.Model):
    lesson = models.ForeignKey(Lesson, on_delete=models.CASCADE, related_name='recordings')
    
    # Zoom –¥–∞–Ω–Ω—ã–µ
    zoom_recording_id = models.CharField(max_length=100, blank=True)
    download_url = models.URLField(blank=True)  # –í—Ä–µ–º–µ–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞ Zoom
    play_url = models.URLField(blank=True)      # –°—Å—ã–ª–∫–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
    
    # Google Drive —Ö—Ä–∞–Ω–µ–Ω–∏–µ
    storage_provider = models.CharField(max_length=20, default='gdrive')
    gdrive_file_id = models.CharField(max_length=100, blank=True)
    gdrive_folder_id = models.CharField(max_length=100, blank=True)
    archive_url = models.URLField(blank=True)   # –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞ Drive
    archive_key = models.CharField(max_length=500, blank=True)
    thumbnail_url = models.URLField(blank=True)
    
    # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
    file_size = models.BigIntegerField(null=True, blank=True)  # –±–∞–π—Ç—ã
    duration = models.IntegerField(null=True, blank=True)       # —Å–µ–∫—É–Ω–¥—ã
    recording_start = models.DateTimeField(null=True, blank=True)
    recording_end = models.DateTimeField(null=True, blank=True)
    
    # –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏
    status = models.CharField(
        max_length=20,
        choices=[
            ('processing', '–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è'),
            ('ready', '–ì–æ—Ç–æ–≤–∞'),
            ('archived', '–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∞'),
            ('failed', '–û—à–∏–±–∫–∞'),
            ('deleted', '–£–¥–∞–ª–µ–Ω–∞'),
        ],
        default='processing'
    )
    
    # –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
    available_until = models.DateTimeField(null=True, blank=True)
    views_count = models.IntegerField(default=0)
    
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
```

### 2.3 TeacherStorageQuota (–∫–≤–æ—Ç–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞)

```python
class TeacherStorageQuota(models.Model):
    teacher = models.OneToOneField(CustomUser, on_delete=models.CASCADE, related_name='storage_quota')
    
    # –ö–≤–æ—Ç—ã (–±–∞–π—Ç—ã)
    total_quota_bytes = models.BigIntegerField(default=5368709120)  # 5 GB –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    used_bytes = models.BigIntegerField(default=0)
    
    # –ú–µ—Ç—Ä–∏–∫–∏
    recordings_count = models.IntegerField(default=0)
    purchased_gb = models.IntegerField(default=0)  # –î–æ–∫—É–ø–ª–µ–Ω–æ GB —Å–≤–µ—Ä—Ö –±–∞–∑—ã
    
    # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    warning_sent = models.BooleanField(default=False)       # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ 80%
    last_warning_at = models.DateTimeField(null=True, blank=True)
    quota_exceeded = models.BooleanField(default=False)     # –ö–≤–æ—Ç–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∞
    
    @property
    def total_gb(self):
        return self.total_quota_bytes / (1024 ** 3)
    
    @property
    def used_gb(self):
        return self.used_bytes / (1024 ** 3)
    
    @property
    def usage_percent(self):
        if self.total_quota_bytes == 0:
            return 0
        return (self.used_bytes / self.total_quota_bytes) * 100
    
    def can_upload(self, file_size_bytes):
        return (self.used_bytes + file_size_bytes) <= self.total_quota_bytes
    
    def add_recording(self, file_size_bytes):
        self.used_bytes += file_size_bytes
        self.recordings_count += 1
        if self.used_bytes >= self.total_quota_bytes:
            self.quota_exceeded = True
        if self.usage_percent >= 80 and not self.warning_sent:
            self.warning_sent = True
            self.last_warning_at = timezone.now()
        self.save()
    
    def remove_recording(self, file_size_bytes):
        self.used_bytes = max(0, self.used_bytes - file_size_bytes)
        self.recordings_count = max(0, self.recordings_count - 1)
        if self.used_bytes < self.total_quota_bytes:
            self.quota_exceeded = False
        if self.usage_percent < 80:
            self.warning_sent = False
        self.save()
    
    def increase_quota(self, additional_gb):
        additional_bytes = int(additional_gb * (1024 ** 3))
        self.total_quota_bytes += additional_bytes
        self.purchased_gb += additional_gb
        self.save()
```

---

## 3. Backend API

### 3.1 –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø–∏—Å–µ–π (—É—á–µ–Ω–∏–∫–∏)

**Endpoint:** `GET /schedule/api/recordings/`  
**–ü—Ä–∞–≤–∞:** `IsAuthenticated` (—É—á–µ–Ω–∏–∫ –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–∏ —Å–≤–æ–∏—Ö –≥—Ä—É–ø–ø)

```python
# teaching_panel/schedule/views.py

@api_view(['GET'])
@permission_classes([IsAuthenticated])
def student_recordings_list(request):
    """–°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—á–µ–Ω–∏–∫—É"""
    user = request.user
    if user.role == 'student':
        recordings = LessonRecording.objects.filter(
            lesson__group__students=user,
            status='ready',
            available_until__gte=timezone.now()  # –ï—â–µ –Ω–µ –∏—Å—Ç–µ–∫–ª–∞
        ).select_related('lesson', 'lesson__group').order_by('-lesson__start_time')
    else:
        return Response({'error': '–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω'}, status=403)
    
    serializer = LessonRecordingSerializer(recordings, many=True)
    return Response(serializer.data)
```

### 3.2 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—è–º–∏ (–ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏)

**Endpoint:** `GET /schedule/api/recordings/teacher/`  
**–ü—Ä–∞–≤–∞:** `IsAuthenticated` (—Ä–æ–ª—å teacher)

```python
@api_view(['GET'])
@permission_classes([IsAuthenticated])
def teacher_recordings_list(request):
    """–°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è"""
    user = request.user
    if user.role != 'teacher':
        return Response({'error': '–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω'}, status=403)
    
    recordings = LessonRecording.objects.filter(
        lesson__teacher=user
    ).select_related('lesson', 'lesson__group').order_by('-created_at')
    
    serializer = LessonRecordingSerializer(recordings, many=True)
    return Response(serializer.data)
```

**Endpoint:** `POST /schedule/api/recordings/{id}/view/`  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –£–≤–µ–ª–∏—á–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤

```python
@api_view(['POST'])
@permission_classes([IsAuthenticated])
def recording_view(request, recording_id):
    recording = get_object_or_404(LessonRecording, id=recording_id)
    recording.views_count += 1
    recording.save(update_fields=['views_count'])
    return Response({'views': recording.views_count})
```

**Endpoint:** `DELETE /schedule/api/recordings/{id}/`  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å (—Ç–æ–ª—å–∫–æ —É—á–∏—Ç–µ–ª—å)

```python
@api_view(['DELETE'])
@permission_classes([IsAuthenticated])
def delete_recording(request, recording_id):
    recording = get_object_or_404(LessonRecording, id=recording_id)
    if recording.lesson.teacher != request.user:
        return Response({'error': '–ù–µ—Ç –ø—Ä–∞–≤'}, status=403)
    
    # –£–¥–∞–ª–∏—Ç—å –∏–∑ Google Drive
    if recording.gdrive_file_id:
        gdrive = get_gdrive_manager()
        gdrive.delete_file(recording.gdrive_file_id)
    
    # –û—Å–≤–æ–±–æ–¥–∏—Ç—å –∫–≤–æ—Ç—É
    if recording.file_size:
        try:
            quota = TeacherStorageQuota.objects.get(teacher=recording.lesson.teacher)
            quota.remove_recording(recording.file_size)
        except TeacherStorageQuota.DoesNotExist:
            pass
    
    recording.delete()
    return Response({'message': '–ó–∞–ø–∏—Å—å —É–¥–∞–ª–µ–Ω–∞'})
```

### 3.3 –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–∏—Å–µ–π –≤—Ä—É—á–Ω—É—é

**Endpoint:** `POST /schedule/api/lessons/{id}/upload_recording/`  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —É—Ä–æ–∫–∞

```python
@api_view(['POST'])
@permission_classes([IsAuthenticated])
def upload_recording(request, lesson_id):
    lesson = get_object_or_404(Lesson, id=lesson_id, teacher=request.user)
    
    if 'video' not in request.FILES:
        return Response({'error': '–§–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω'}, status=400)
    
    video_file = request.FILES['video']
    file_size = video_file.size
    
    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–≤–æ—Ç—É
    try:
        quota = TeacherStorageQuota.objects.get(teacher=request.user)
        if not quota.can_upload(file_size):
            return Response({'error': '–ü—Ä–µ–≤—ã—à–µ–Ω–∞ –∫–≤–æ—Ç–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞'}, status=403)
    except TeacherStorageQuota.DoesNotExist:
        quota = TeacherStorageQuota.objects.create(teacher=request.user)
    
    # –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ Google Drive
    gdrive = get_gdrive_manager()
    file_name = f"{lesson.group.name} - {lesson.title} - {timezone.now().strftime('%Y-%m-%d %H:%M')}.mp4"
    file_id = gdrive.upload_file(video_file, file_name)
    
    # –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å
    recording = LessonRecording.objects.create(
        lesson=lesson,
        storage_provider='gdrive',
        gdrive_file_id=file_id,
        file_size=file_size,
        status='ready',
        available_until=timezone.now() + timedelta(days=lesson.recording_available_for_days) if lesson.recording_available_for_days > 0 else None
    )
    
    # –û–±–Ω–æ–≤–∏—Ç—å –∫–≤–æ—Ç—É
    quota.add_recording(file_size)
    
    return Response(LessonRecordingSerializer(recording).data, status=201)
```

---

## 4. Frontend UI

### 4.1 –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–ø–∏—Å–µ–π –¥–ª—è —É—á–µ–Ω–∏–∫–æ–≤

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `frontend/src/modules/Recordings/RecordingsPage.js`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π —Å –ø—Ä–µ–≤—å—é
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≥—Ä—É–ø–ø–µ, –ø—Ä–µ–¥–º–µ—Ç—É, –¥–∞—Ç–µ
- –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —É—Ä–æ–∫–∞
- –ü–ª–µ–µ—Ä –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Google Drive player)
- –°—á–µ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä "–ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å" (–µ—Å–ª–∏ < 7 –¥–Ω–µ–π)

**–ú–∞–∫–µ—Ç:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìπ –ó–∞–ø–∏—Å–∏ —É—Ä–æ–∫–æ–≤                        ‚îÇ
‚îÇ [–ü–æ–∏—Å–∫...]  [–ì—Ä—É–ø–ø–∞ ‚ñæ] [–ü—Ä–µ–¥–º–µ—Ç ‚ñæ]      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ ‚îÇ [–ü—Ä–µ–≤—å—é] ‚îÇ  ‚îÇ [–ü—Ä–µ–≤—å—é] ‚îÇ  ‚îÇ [–ü—Ä–µ–≤—å—é] ‚îÇ‚îÇ
‚îÇ ‚îÇ –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞‚îÇ  ‚îÇ –§–∏–∑–∏–∫–∞   ‚îÇ  ‚îÇ –•–∏–º–∏—è   ‚îÇ‚îÇ
‚îÇ ‚îÇ 02.12.2025‚îÇ  ‚îÇ 01.12.2025‚îÇ  ‚îÇ30.11.2025‚îÇ‚îÇ
‚îÇ ‚îÇ üëÅ 15     ‚îÇ  ‚îÇ üëÅ 8     ‚îÇ  ‚îÇ üëÅ 23    ‚îÇ‚îÇ
‚îÇ ‚îÇ [–°–º–æ—Ç—Ä–µ—Ç—å]‚îÇ  ‚îÇ [–°–º–æ—Ç—Ä–µ—Ç—å]‚îÇ  ‚îÇ [–°–º–æ—Ç—Ä–µ—Ç—å]‚îÇ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îÇ ...                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 4.2 –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å—è–º–∏ (–ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å)

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `frontend/src/modules/Recordings/TeacherRecordingsPage.js`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- –í—Å–µ –∑–∞–ø–∏—Å–∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- –°—Ç–∞—Ç—É—Å—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–≥–æ—Ç–æ–≤–æ / –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è / –æ—à–∏–±–∫–∞)
- –ö–Ω–æ–ø–∫–∞ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ" –¥–ª—è —Ä—É—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
- –§–∏–ª—å—Ç—Ä—ã –ø–æ –≥—Ä—É–ø–ø–µ, —Å—Ç–∞—Ç—É—Å—É
- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –∫–≤–æ—Ç—ã —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

**–ú–∞–∫–µ—Ç:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìπ –ó–∞–ø–∏—Å–∏ –º–æ–∏—Ö —É—Ä–æ–∫–æ–≤    [‚¨Ü –ó–∞–≥—Ä—É–∑–∏—Ç—å] ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –ö–≤–æ—Ç–∞: 2.3 / 5.0 GB  [‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë] 46%   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:                              ‚îÇ
‚îÇ [üìä 42 –í—Å–µ–≥–æ] [‚úÖ 38 –ì–æ—Ç–æ–≤–æ] [‚è≥ 3 –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è] [‚ùå 1 –û—à–∏–±–∫–∞] ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ [–ü–æ–∏—Å–∫...] [–ì—Ä—É–ø–ø–∞ ‚ñæ] [–°—Ç–∞—Ç—É—Å ‚ñæ] [üîÑ]   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ ‚îÇ [–ü—Ä–µ–≤—å—é] ‚îÇ  ‚îÇ [–ü—Ä–µ–≤—å—é] ‚îÇ  ‚îÇ [–ü—Ä–µ–≤—å—é] ‚îÇ‚îÇ
‚îÇ ‚îÇ –ì—Ä—É–ø–ø–∞ A ‚îÇ  ‚îÇ –ì—Ä—É–ø–ø–∞ B ‚îÇ  ‚îÇ –ì—Ä—É–ø–ø–∞ C ‚îÇ‚îÇ
‚îÇ ‚îÇ 02.12    ‚îÇ  ‚îÇ 01.12    ‚îÇ  ‚îÇ 30.11    ‚îÇ‚îÇ
‚îÇ ‚îÇ üëÅ 15 üóëÔ∏è  ‚îÇ  ‚îÇ ‚è≥ üóëÔ∏è     ‚îÇ  ‚îÇ üëÅ 8 üóëÔ∏è  ‚îÇ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 4.3 –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–≥—Ä—É–∑–∫–∏

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- Drag & drop –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–∏–¥–µ–æ —Ñ–∞–π–ª–æ–≤
- –í—ã–±–æ—Ä —É—Ä–æ–∫–∞ (–∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ standalone –∑–∞–ø–∏—Å–∏)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ (–≤—Å–µ / –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≥—Ä—É–ø–ø—ã / —É—á–µ–Ω–∏–∫–∏)
- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –∑–∞–≥—Ä—É–∑–∫–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ (—Ç–æ–ª—å–∫–æ video/*)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–≤–æ—Ç—ã –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏

---

## 5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∂–∞—Ç–∏–µ –∑–∞–ø–∏—Å–µ–π

### 5.1 –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –í–∏–¥–µ–æ –∑–∞–Ω—è—Ç–∏–π —á–∞—Å—Ç–æ –≤–µ—Å—è—Ç 500 MB - 2 GB –∑–∞ —á–∞—Å, –±—ã—Å—Ç—Ä–æ –∏—Å—á–µ—Ä–ø—ã–≤–∞—è –∫–≤–æ—Ç—É.

**–†–µ—à–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∂–∞—Ç–∏–µ —á–µ—Ä–µ–∑ FFmpeg –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞.

**–¶–µ–ª–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- **–í–∏–¥–µ–æ–∫–æ–¥–µ–∫:** H.264 (x264) —Å –ø—Ä–µ—Å–µ—Ç–æ–º `medium`
- **–ë–∏—Ç—Ä–µ–π—Ç:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π (VBR), —Ü–µ–ª–µ–≤–æ–π ~1 Mbps –¥–ª—è 720p
- **–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ:** 1280x720 (–µ—Å–ª–∏ –∏—Å—Ö–æ–¥–Ω–æ–µ –≤—ã—à–µ)
- **–ê—É–¥–∏–æ–∫–æ–¥–µ–∫:** AAC, 128 kbps
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ 60-80% –±–µ–∑ –∑–∞–º–µ—Ç–Ω–æ–π –ø–æ—Ç–µ—Ä–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–ª—è —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª–µ–π

### 5.2 –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ FFmpeg –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install ffmpeg -y

# –ü—Ä–æ–≤–µ—Ä–∫–∞
ffmpeg -version
```

#### Python –æ–±–µ—Ä—Ç–∫–∞ (gdrive_utils.py)

```python
import subprocess
import tempfile
import os

def compress_video(input_path, output_path):
    """
    –°–∂–∏–º–∞–µ—Ç –≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ FFmpeg
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - input_path: –ø—É—Ç—å –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É
    - output_path: –ø—É—Ç—å –∫ —Å–∂–∞—Ç–æ–º—É —Ñ–∞–π–ª—É
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - True –µ—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ, False –µ—Å–ª–∏ –æ—à–∏–±–∫–∞
    """
    try:
        # FFmpeg –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Å–∂–∞—Ç–∏—è
        cmd = [
            'ffmpeg',
            '-i', input_path,                    # –í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª
            '-c:v', 'libx264',                   # –í–∏–¥–µ–æ–∫–æ–¥–µ–∫ H.264
            '-preset', 'medium',                 # –ë–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç—å/–∫–∞—á–µ—Å—Ç–≤–æ
            '-crf', '23',                        # Constant Rate Factor (18-28, 23 = —Ö–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ)
            '-vf', 'scale=1280:720',             # –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –¥–æ 720p
            '-c:a', 'aac',                       # –ê—É–¥–∏–æ–∫–æ–¥–µ–∫ AAC
            '-b:a', '128k',                      # –ë–∏—Ç—Ä–µ–π—Ç –∞—É–¥–∏–æ
            '-movflags', '+faststart',           # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –≤–µ–±-—Å—Ç—Ä–∏–º–∏–Ω–≥–∞
            '-y',                                # –ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
            output_path
        ]
        
        # –ó–∞–ø—É—Å—Ç–∏—Ç—å FFmpeg
        result = subprocess.run(
            cmd,
            stdout=subprocess.PIPE,
            stderr=subprocess.PIPE,
            timeout=3600  # –¢–∞–π–º–∞—É—Ç 1 —á–∞—Å
        )
        
        if result.returncode == 0:
            # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω –∏ –º–µ–Ω—å—à–µ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞
            if os.path.exists(output_path):
                original_size = os.path.getsize(input_path)
                compressed_size = os.path.getsize(output_path)
                compression_ratio = (1 - compressed_size / original_size) * 100
                
                logger.info(f"Video compressed: {original_size / (1024**2):.1f} MB ‚Üí {compressed_size / (1024**2):.1f} MB ({compression_ratio:.1f}% reduction)")
                return True
        else:
            logger.error(f"FFmpeg failed: {result.stderr.decode()}")
            return False
            
    except subprocess.TimeoutExpired:
        logger.error("FFmpeg timeout (>1 hour)")
        return False
    except Exception as e:
        logger.error(f"Compression error: {e}")
        return False
```

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Celery task

```python
# teaching_panel/schedule/tasks.py

@shared_task
def process_zoom_recording(recording_id):
    """–°–∫–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å —Å Zoom, —Å–∂–∞—Ç—å, –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ Google Drive"""
    try:
        recording = LessonRecording.objects.get(id=recording_id)
        
        # 1. –°–∫–∞—á–∞—Ç—å —Å Zoom
        temp_original = tempfile.NamedTemporaryFile(delete=False, suffix='.mp4')
        response = requests.get(recording.download_url, stream=True)
        for chunk in response.iter_content(chunk_size=8192):
            temp_original.write(chunk)
        temp_original.close()
        
        original_size = os.path.getsize(temp_original.name)
        logger.info(f"Downloaded from Zoom: {original_size / (1024**2):.1f} MB")
        
        # 2. –°–∂–∞—Ç—å —á–µ—Ä–µ–∑ FFmpeg
        temp_compressed = tempfile.NamedTemporaryFile(delete=False, suffix='.mp4')
        temp_compressed.close()
        
        if compress_video(temp_original.name, temp_compressed.name):
            compressed_size = os.path.getsize(temp_compressed.name)
            upload_file = temp_compressed.name
            final_size = compressed_size
            logger.info(f"Compression successful: {compressed_size / (1024**2):.1f} MB")
        else:
            # –ï—Å–ª–∏ —Å–∂–∞—Ç–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å, –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª
            logger.warning("Compression failed, uploading original")
            upload_file = temp_original.name
            final_size = original_size
        
        # 3. –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ Google Drive
        gdrive = get_gdrive_manager()
        file_name = f"{recording.lesson.group.name} - {recording.lesson.title} - {recording.created_at.strftime('%Y-%m-%d %H:%M')}.mp4"
        
        with open(upload_file, 'rb') as f:
            file_id = gdrive.upload_file(f, file_name)
        
        # 4. –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å
        recording.gdrive_file_id = file_id
        recording.file_size = final_size
        recording.status = 'ready'
        recording.save()
        
        # 5. –û–±–Ω–æ–≤–∏—Ç—å –∫–≤–æ—Ç—É –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
        try:
            quota = TeacherStorageQuota.objects.get(teacher=recording.lesson.teacher)
            quota.add_recording(final_size)
        except TeacherStorageQuota.DoesNotExist:
            quota = TeacherStorageQuota.objects.create(teacher=recording.lesson.teacher)
            quota.add_recording(final_size)
        
        # 6. –£–¥–∞–ª–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
        os.remove(temp_original.name)
        if temp_compressed.name != temp_original.name:
            os.remove(temp_compressed.name)
        
        logger.info(f"Recording processed successfully: {file_id}")
        return True
        
    except Exception as e:
        logger.error(f"Error processing recording {recording_id}: {e}")
        recording.status = 'failed'
        recording.save()
        return False
```

### 5.3 –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∂–∞—Ç–∏—è

**–í `settings.py`:**

```python
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∂–∞—Ç–∏—è –≤–∏–¥–µ–æ
VIDEO_COMPRESSION_ENABLED = True
VIDEO_MAX_RESOLUTION = '1280:720'  # 720p
VIDEO_CRF = 23                     # –ö–∞—á–µ—Å—Ç–≤–æ (18-28, —á–µ–º –Ω–∏–∂–µ = –ª—É—á—à–µ)
VIDEO_PRESET = 'medium'            # –°–∫–æ—Ä–æ—Å—Ç—å —Å–∂–∞—Ç–∏—è (ultrafast/fast/medium/slow)
AUDIO_BITRATE = '128k'             # –ë–∏—Ç—Ä–µ–π—Ç –∞—É–¥–∏–æ

# –û—Ç–∫–ª—é—á–∏—Ç—å —Å–∂–∞—Ç–∏–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
# VIDEO_COMPRESSION_ENABLED = False
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –≠–∫–æ–Ω–æ–º–∏—è 60-80% –º–µ—Å—Ç–∞
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è —É—á–µ–Ω–∏–∫–æ–≤
- ‚úÖ –ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ Google Drive API
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ 720p (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª–µ–π)

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (~5-10 –º–∏–Ω—É—Ç –¥–ª—è —á–∞—Å–æ–≤–æ–π –∑–∞–ø–∏—Å–∏)
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –º–æ—â–Ω—ã–π CPU –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–º–µ—Ç–Ω–∞ –Ω–µ–±–æ–ª—å—à–∞—è –ø–æ—Ç–µ—Ä—è –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ –æ—á–µ–Ω—å –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö

---

## 6. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–≤–æ—Ç–∞–º–∏

### 6.1 –ë–∞–∑–æ–≤–∞—è –∫–≤–æ—Ç–∞

- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:** 5 GB –Ω–∞ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
- –ü—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –ø–æ–¥–ø–∏—Å–∫–µ (—Å–º. `accounts/models.py::Subscription`)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ –∑–∞–ø–∏—Å–∏

### 6.2 –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–≤–æ—Ç—ã

**Endpoint:** `POST /accounts/api/admin/teachers/{id}/storage/`  
**Body:** `{ "extra_gb": 10 }`

```python
# teaching_panel/accounts/admin_views.py

class AdminTeacherStorageView(APIView):
    def post(self, request, teacher_id):
        teacher = get_object_or_404(User, id=teacher_id, role='teacher')
        extra_gb = int(request.data.get('extra_gb', 0))
        
        if extra_gb <= 0:
            return Response({'error': '–£–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ GB > 0'}, status=400)
        
        subscription = get_subscription(teacher)
        subscription.extra_storage_gb += extra_gb
        subscription.save()
        
        # –¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–∏—Ç—å TeacherStorageQuota –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        try:
            quota = TeacherStorageQuota.objects.get(teacher=teacher)
            quota.increase_quota(extra_gb)
        except TeacherStorageQuota.DoesNotExist:
            pass
        
        return Response({'message': f'–î–æ–±–∞–≤–ª–µ–Ω–æ {extra_gb} GB'})
```

### 6.3 –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫–≤–æ—Ç–µ

**Trigger 1: 80% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**
- –§–ª–∞–≥ `warning_sent = True`
- –û—Ç–ø—Ä–∞–≤–∫–∞ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: "‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ 80% —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (4.0 / 5.0 GB). –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ –∏–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å –∫–≤–æ—Ç—É."

**Trigger 2: 100% (–∫–≤–æ—Ç–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∞)**
- –§–ª–∞–≥ `quota_exceeded = True`
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "‚ùå –ö–≤–æ—Ç–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏—Å—á–µ—Ä–ø–∞–Ω–∞! –£–¥–∞–ª–∏—Ç–µ –∑–∞–ø–∏—Å–∏ –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è."

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```python
# teaching_panel/accounts/notifications.py

def notify_storage_quota_warning(teacher):
    """–£–≤–µ–¥–æ–º–∏—Ç—å –æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 80% –∫–≤–æ—Ç—ã"""
    if not teacher.telegram_chat_id:
        return
    
    quota = teacher.storage_quota
    message = (
        f"‚ö†Ô∏è <b>–í–Ω–∏–º–∞–Ω–∏–µ!</b>\n\n"
        f"–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ <b>{quota.usage_percent:.0f}%</b> —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∑–∞–ø–∏—Å–µ–π:\n"
        f"üìä {quota.used_gb:.2f} / {quota.total_gb:.2f} GB\n\n"
        f"–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ –∏–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å –∫–≤–æ—Ç—É."
    )
    
    send_telegram_notification(teacher.telegram_chat_id, message)
    
def notify_storage_quota_exceeded(teacher):
    """–£–≤–µ–¥–æ–º–∏—Ç—å –æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –∫–≤–æ—Ç—ã"""
    if not teacher.telegram_chat_id:
        return
    
    quota = teacher.storage_quota
    message = (
        f"‚ùå <b>–ö–≤–æ—Ç–∞ –∏—Å—á–µ—Ä–ø–∞–Ω–∞!</b>\n\n"
        f"–•—Ä–∞–Ω–∏–ª–∏—â–µ –∑–∞–ø–∏—Å–µ–π –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–æ:\n"
        f"üìä {quota.used_gb:.2f} / {quota.total_gb:.2f} GB\n\n"
        f"–ù–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ –Ω–µ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è.\n"
        f"–£–¥–∞–ª–∏—Ç–µ –∑–∞–ø–∏—Å–∏ –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É."
    )
    
    send_telegram_notification(teacher.telegram_chat_id, message)
```

---

## 7. –ß–µ–∫-–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### Backend
- [x] –ú–æ–¥–µ–ª–∏ `Lesson`, `LessonRecording`, `TeacherStorageQuota`
- [x] Zoom webhook handler (`webhooks.py`)
- [x] Google Drive –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (`gdrive_utils.py`)
- [x] Celery task `process_zoom_recording`
- [x] Celery task `cleanup_old_recordings`
- [x] API endpoints –¥–ª—è –∑–∞–ø–∏—Å–µ–π (—Å–ø–∏—Å–æ–∫, –¥–µ—Ç–∞–ª–∏, —É–¥–∞–ª–µ–Ω–∏–µ)
- [x] Endpoint –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Ä—É—á–Ω—É—é
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–≤–æ—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- [ ] FFmpeg —Å–∂–∞—Ç–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –≥–æ—Ç–æ–≤–æ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫–≤–æ—Ç–µ (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram)

### Frontend
- [x] `RecordingsPage.js` (—É—á–µ–Ω–∏–∫–∏)
- [x] `TeacherRecordingsPage.js` (–ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏)
- [x] `RecordingCard.js` (–∫–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–ø–∏—Å–∏)
- [x] `RecordingPlayer.js` (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–ª–µ–µ—Ä)
- [ ] Drag & drop –∑–∞–≥—Ä—É–∑–∫–∞ (—á–∞—Å—Ç–∏—á–Ω–æ –≥–æ—Ç–æ–≤–æ)
- [ ] –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –∫–≤–æ—Ç—ã –Ω–∞ –¥–∞—à–±–æ—Ä–¥–µ
- [ ] –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [x] Google Drive Service Account –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [x] Zoom webhook –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
- [x] Celery worker –∑–∞–ø—É—â–µ–Ω
- [x] Celery beat –¥–ª—è cleanup –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] FFmpeg —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–≤–æ—Ç (dashboard)

---

## 8. –°–æ–≤–µ—Ç—ã –ø–æ –æ—Ç–ª–∞–¥–∫–µ

### –ó–∞–ø–∏—Å–∏ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–æ—Å–ª–µ —É—Ä–æ–∫–∞
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `record_lesson=True` –Ω–∞ —É—Ä–æ–∫–µ
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Zoom webhook –≤ –ª–æ–≥–∞—Ö: `sudo journalctl -u teaching_panel | grep webhook`
3. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ Celery worker –∑–∞–ø—É—â–µ–Ω: `sudo systemctl status celery`
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–∏ –≤ Zoom Cloud Storage (–º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–ª–≥–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)

### –°–∂–∞—Ç–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å FFmpeg: `sudo apt install ffmpeg -y`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é: `ffmpeg -version` (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å >= 4.0)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Celery: `sudo tail -f /var/log/celery.log | grep compress`
4. –û—Ç–∫–ª—é—á–∏—Ç—å —Å–∂–∞—Ç–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ: `VIDEO_COMPRESSION_ENABLED = False` –≤ `settings.py`

### –ö–≤–æ—Ç–∞ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ `TeacherStorageQuota`: `python manage.py shell` ‚Üí `TeacherStorageQuota.objects.all()`
2. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ `add_recording()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –º–µ–∂–¥—É `Subscription.extra_storage_gb` –∏ `TeacherStorageQuota.total_quota_bytes`

### Google Drive –æ—à–∏–±–∫–∞ 403
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Service Account –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ Editor –Ω–∞ –ø–∞–ø–∫—É
2. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ `gdrive-credentials.json` —á–∏—Ç–∞–µ–º: `chmod 600 gdrive-credentials.json`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `GDRIVE_RECORDINGS_FOLDER_ID` –≤ `settings.py`

---

## 9. –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –±–∏—Ç—Ä–µ–π—Ç:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HLS/DASH –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–æ–¥—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ–¥ —Å–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
2. **–°—É–±—Ç–∏—Ç—Ä—ã:** –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—É–±—Ç–∏—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ Google Speech-to-Text API
3. **–ó–∞–∫–ª–∞–¥–∫–∏:** –ü–æ–∑–≤–æ–ª–∏—Ç—å —É—á–µ–Ω–∏–∫–∞–º —Å—Ç–∞–≤–∏—Ç—å –º–µ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
4. **–û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º:** –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–∏—Å–µ–π –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ (–º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
5. **AI –∞–Ω–∞–ª–∏–∑:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤ —É—Ä–æ–∫–∞
6. **–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ S3/Azure:** –ï—Å–ª–∏ Google Drive –ª–∏–º–∏—Ç—ã —Å—Ç–∞–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º–æ–π

---

–°–ª–µ–¥—É—è —ç—Ç–æ–º—É —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É, –º–æ–∂–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–∏—Å—Ç–µ–º–æ–π –∑–∞–ø–∏—Å–µ–π —É—Ä–æ–∫–æ–≤, –æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞—Ö–≤–∞—Ç–∞ —á–µ—Ä–µ–∑ Zoom –¥–æ —Ä—É—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏, —Å –≥–∏–±–∫–∏–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –∫–≤–æ—Ç –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–∂–∞—Ç–∏–µ–º –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞.
